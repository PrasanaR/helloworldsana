pipeline {
    agent any
    environment {
        PATH = "/usr/bin:$PATH"
    }
    stages {
        
        stage("Git Code Check - Truffle"){
            steps{
              sh '''
              rm -r trufflehog || true
              docker run gesellix/trufflehog --json https://github.com/PrasanaR/helloworldsana.git > trufflehog.json
              cat trufflehog.json
              '''
            }
        }
         stage("Owasp Dependancy Check"){
            steps{
              sh '''
              rm -r owasp* || true
              wget  'https://github.com/PrasanaR/helloworldsana/blob/main/owasp-dependancy-check.sh'
              chmod +x owasp-dependancy-check.sh
              bash owasp-dependancy-check.sh
              '''
            }
        }
        
       
        
        stage("build code"){
            steps{
              sh "mvn clean package"
            }
        }
        stage("deploy"){
            steps{
              
                 sh "mv webapp/target/webapp.war /opt/tomcat/latest/webapps/webapp.war"
                
            }
        }
    }
}
