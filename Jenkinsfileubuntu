pipeline {
    agent any
    environment {
        PATH = "/usr/bin:$PATH"
    }
    stages {
        
        stage("Git Code Check - Truffle"){
            steps{
              sh '''
              rm -r trufflehog || true
              docker run gesellix/trufflehog --json https://github.com/PrasanaR/helloworldsana.git > trufflehog.json
              cat trufflehog.json
              '''
            }
        }
         stage("Owasp Dependancy Check"){
            steps{
              sh '''
              rm -r owasp* || true
              wget 'https://raw.githubusercontent.com/PrasanaR/helloworldsana/main/owasp-dependancy-check.sh'
              chmod +x owasp*
              //bash owasp*
              '''
            }
        }
        
       /* stage("owasp"){
            
            steps{
                dependencyCheck additionalArguments: '', odcInstallation: 'owasp'
            }
        }*/
        
       
        
        stage("build code"){
            steps{
              sh "mvn clean package"
            }
        }
        stage("deploy"){
            steps{
              
                 sh "mv webapp/target/webapp.war /opt/tomcat/latest/webapps/webapp.war"
                
            }
        }
    }
}
